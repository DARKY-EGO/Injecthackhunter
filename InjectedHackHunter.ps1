<the full code the user provided here>